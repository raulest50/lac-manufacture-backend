@host = {{host}}
@contentType = {{contentType}}
# Obtén {{auth_token}} ejecutando previamente ../users/auth.http
@ordenId = 1

### (Opcional) Crear una orden de producción de prueba
# Ejecuta esta petición si tu entorno no cuenta con órdenes registradas.
# Actualiza @ordenId con el valor devuelto en el campo ordenId de la respuesta.
POST {{host}}/produccion/save
Content-Type: {{contentType}}
Authorization: Bearer {{auth_token}}

{
  "productoId": "PROD-001",
  "observaciones": "Orden de prueba creada desde HTTP Client",
  "cantidadProducir": 10,
  "areaOperativa": "Laboratorio",
  "departamentoOperativo": "Producción"
}

### Obtener insumos de una orden de producción
GET {{host}}/produccion/orden_produccion/{{ordenId}}/insumos
Content-Type: {{contentType}}
Authorization: Bearer {{auth_token}}

> {%
    client.test("Respuesta 200", function() {
        client.assert(response.status === 200, "Se esperaba HTTP 200");
    });
    client.test("Respuesta es un arreglo", function() {
        client.assert(Array.isArray(response.body), "La respuesta debe ser una lista");
    });
    if (response.body.length > 0) {
        const item = response.body[0];
        client.test("Campos básicos presentes", function() {
            client.assert(item.productoId, "productoId faltante");
            client.assert(item.nombreProducto, "nombreProducto faltante");
            client.assert(item.hasOwnProperty("cantidadRequerida"), "cantidadRequerida faltante");
        });
    }
%}
